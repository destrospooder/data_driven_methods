{"title":"System Identification Techniques","markdown":{"headingText":"System Identification Techniques","containsRefs":false,"markdown":"\n## Overview: Eigensystem Realization Algorithm\n\nThe Eigensystem Realization Algorithm (ERA) is a method used in system identification to derive a state-space model from time-domain data, typically impulse or step response data.\n\n::: {.callout-tip}\n## Hankel Matrix\nA Hankel matrix is a structured matrix where each ascending diagonal from left to right is constant.\n:::\n\nTwo Hankel matrices are constructed from the collected data. Let $\\textbf{y}$ be the sequence of observed data points. Then the Hankel matrix $\\textbf{H}_0$ and the shifted Hankel matrix $\\textbf{H}_1$ are defined as:\n\n$$\n\\textbf{H}_0 = \\begin{bmatrix}\ny_1 & y_2 & \\cdots & y_m \\\\\ny_2 & y_3 & \\cdots & y_{m+1} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\ny_n & y_{n+1} & \\cdots & y_{n+m-1}\n\\end{bmatrix}\n$$\n\n$$\n\\textbf{H}_1 = \\begin{bmatrix}\ny_2 & y_3 & \\cdots & y_{m+1} \\\\\ny_3 & y_4 & \\cdots & y_{m+2} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\ny_{n+1} & y_{n+2} & \\cdots & y_{n+m}\n\\end{bmatrix}\n$$\n\nThe singular value decomposition (SVD) is performed on $\\textbf{H}_0$ (and truncated to keep only the most significant singular values):\n\n$$\\textbf{H}_0 = \\textbf{U} \\Sigma \\textbf{V}^* \\approx \\textbf{U}_r \\Sigma_r \\textbf{V}^*_r$$\n\nThe reduced matrices are used to construct the state-space matrices $\\textbf{A}$, $\\textbf{B}$, and $\\textbf{C}$:\n\n$$\\textbf{A} = \\Sigma_r^{-0.5} \\textbf{U}_r^* \\textbf{H}_1 \\textbf{V}_r \\Sigma_r^{-0.5}$$\n$$\\textbf{B} = \\Sigma_r^{0.5} \\textbf{V}_r^* [:, 0]$$\n$$\\textbf{C} = \\textbf{U}_r [0, :] \\Sigma_r^{0.5} $$\n\nWhen constructing the Hankel matrices, collecting sufficient data ensures balanced controllability and observability Gramians $\\mathcal{O}_d \\mathcal{O}_d^*$ and $\\mathcal{C}_d \\mathcal{C}_d^*$. If data is insufficient, ERA only approximates the balance. Alternatively, collecting enough data for the Hankel matrices to reach numerical full rank (where remaining singular values are below a threshold) yields a low-order ERA model. \n\n## Atomic Force Microscope Transfer Function Recovery\nWe use the Eigensystem Realization Algorithm (ERA) to perform system identification on a transfer function representing the dynamics of an atomic force microscope.\n\n$$ G(s) = \\frac{k\\omega_2^2 \\omega_3^2 \\omega_5^2 \\left( s^2 + 2\\zeta_1 \\omega_1 s + \\omega_1^2 \\right) \\left( s^2 + 2\\zeta_4 \\omega_4 s + \\omega_4^2 \\right) e^{-s\\tau}}{\\omega_1^2 \\omega_4^2 \\left( s^2 + 2\\zeta_2 \\omega_2 s + \\omega_2^2 \\right) \\left( s^2 + 2\\zeta_3 \\omega_3 s + \\omega_3^2 \\right) \\left( s^2 + 2\\zeta_5 \\omega_5 s + \\omega_5^2 \\right)} $$\n\nwith $\\omega_i = 2\\pi f_i$, $k$ = 5,\n\n\\begin{align*}\nf_1 &= 2.4 \\text{ kHz}, & f_2 &= 2.6 \\text{ kHz}, & f_3 &= 6.5 \\text{ kHz}, & f_4 &= 8.3 \\text{ kHz}, & f_5 &= 9.3 \\text{ kHz,} \\\\\n\\zeta_1 &= 0.03, & \\zeta_2 &= 0.03, & \\zeta_3 &= 0.042, & \\zeta_4 &= 0.025, & \\zeta_5 &= 0.032\n\\end{align*}\n\nand $\\tau = 10^{-4}$ seconds.\n\nA Padé approximant is used to handle the time delay, as the [control](https://python-control.readthedocs.io/en/0.10.0/) library does not support time delays directly.\n\nThe impulse response of the system is computed over a specified time range.\n\n![Impulse response of the provided transfer function.](images/era_figs/original_sys_impulse.png)\n\nHankel matrices are constructed using the impulse response data. The SVD is used to decompose the Hankel matrix into components that facilitate the identification of the system's state-space representation.\n\nThe state-space matrices $\\textbf{A}$, $\\textbf{B}$, and $\\textbf{C}$ are calculated using the truncated SVD components and fractional matrix powers. This step essentially reduces the system to a simplified model while preserving its significant dynamics.\n\nThe squared singular values of the Hankel matrix are plotted to identify the most significant components.\n\n![Most significant Hankel squared singular values.](images/era_figs/hankel_squared_svs.png)\n\nA new state-space model is created using the ERA results. Bode plots of the original and reconstructed systems are generated and compared. These plots visualize the frequency response of both systems, ensuring that the reconstructed model accurately represents the original system's dynamics.\n\n![Frequency responses of the original and reconstructed images.](images/era_figs/freq_responses_compared.png)\n\nDue to the use of the Padé approximant for handling the time delay in the system, there are minor discrepancies in the phase of the frequency response. While it effectively captures the overall behavior of the delay, it can introduce slight inaccuracies in the phase response, especially at higher frequencies. Consequently, the phase response of the system might not perfectly align with the actual phase characteristics, although the magnitude response remains largely unaffected.\n\n## Overview: DMD with Control\n\nDynamic Mode Decomposition with control (DMDc) is a modification of the standard DMD algorithm designed to handle input-output systems where actuation or control inputs are present. In short, the DMDc method tries to find the best-fit linear operators $\\textbf{A}$ and $\\textbf{B}$ that approximately describe the following dynamics based on measurement data:\n\n$$\\textbf{x}_{k+1} \\approx \\textbf{A} \\textbf{x}_k + \\textbf{B} \\textbf{u}_k$$\n\n$\\textbf{X}$ and $\\textbf{X}$' are defined as they were for standard DMD. A matrix of the actuation input history is assembled, defined as follows:\n\n$$\\Upsilon = \\begin{bmatrix} \\textbf{u}_1 & \\textbf{u}_2 & \\cdots & \\textbf{u}_N \\end{bmatrix}$$ \n\n($\\Upsilon$ is used in lieu of $\\textbf{U}$ to disambiguate between the $\\textbf{U}$ matrix in the SVD.) The dynamics are now written:\n\n$$ \\textbf{X}' \\approx \\begin{bmatrix} \\textbf{A} & \\textbf{B} \\end{bmatrix} \\begin{bmatrix} \\textbf{X} \\\\ \\Upsilon \\end{bmatrix} = \\textbf{G} \\Omega$$\n\n$\\textbf{G} = \\begin{bmatrix} \\textbf{A} & \\textbf{B} \\end{bmatrix}$ can be isolated using least-squares regression:\n\n$$\\textbf{G} \\approx \\textbf{X}' \\Omega^+$$\n\nThe singular value decomposition of $\\Omega = \\begin{bmatrix} \\textbf{X}^* & \\Upsilon^* \\end{bmatrix}^*$ is taken:\n\n$$\\Omega = \\tilde{\\textbf{U}} \\tilde{\\Sigma} \\tilde{\\textbf{V}}^*$$\n\n$\\tilde{\\textbf{U}}$ is split into two matrices to provide bases for $\\textbf{X}$ and $\\Upsilon$: \n\n$$\\tilde{\\textbf{U}} = \\begin{bmatrix} \\tilde{\\textbf{U}}_1^* & \\tilde{\\textbf{U}}_2^* \\end{bmatrix}$$\n\nThe state matrices $\\textbf{A}$ and $\\textbf{B}$ can now be constructed:\n\n$$\\textbf{A} = \\textbf{X}' \\tilde{\\textbf{V}} \\tilde{\\Sigma}^{-1} \\tilde{\\textbf{U}}_1^*$$\n$$\\textbf{B} = \\textbf{X}' \\tilde{\\textbf{V}} \\tilde{\\Sigma}^{-1} \\tilde{\\textbf{U}}_2^*$$\n\n$\\tilde{\\textbf{U}}$ provides a reduced basis for the input space, whereas $\\hat{\\textbf{U}}$ from:\n\n$$\\textbf{X}' = \\hat{\\textbf{U}} \\hat{\\Sigma} \\hat{\\textbf{V}}^*$$\n\nprovides a reduced basis for the output space. These bases allow us to reduce the order of $\\textbf{G}$ by projecting onto this basis:\n\n$$\\tilde{\\textbf{G}} = \\hat{\\textbf{U}}^* \\textbf{G} \\begin{bmatrix} \\hat{\\textbf{U}} \\\\ \\textbf{I} \\end{bmatrix}$$\n\nand the corresponding projected matrices $\\tilde{\\textbf{A}}$ and $\\tilde{\\textbf{B}}$ are:\n\n$$\\tilde{\\textbf{A}} = \\hat{\\textbf{U}}^* \\textbf{A}\\hat{\\textbf{U}}$$\n\n$$\\tilde{\\textbf{B}} = \\hat{\\textbf{U}}^* \\textbf{B} $$\n\nThe key difference from standard DMD is the augmented data matrix $\\textbf{G}$, which incorporates both state and control input data. This allows DMDc to disambiguate the underlying dynamics from the effects of actuation, providing an accurate input-output model represented by the modes $\\Phi$ and eigenvalues $\\Lambda$.\n\n$$\\tilde{\\textbf{A}} \\textbf{W} = \\textbf{W} \\Lambda$$\n\n$$ \\Phi = \\textbf{X}' \\tilde{\\textbf{V}} \\tilde{\\Sigma}^{-1} \\tilde{\\textbf{U}}_1^* \\hat{\\textbf{U}} \\textbf{W} $$\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"ch4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"theme":{"light":"cosmo","dark":["cosmo","theme-dark.scss"]},"grid":{"sidebar-width":"300px"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"ch4.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}